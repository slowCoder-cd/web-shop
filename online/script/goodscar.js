"use strict";!function(c){if(c.cookie("sid")&&c.cookie("num")){var e=[],n=[];1==c.cookie("sid").length?(e.push(c.cookie("sid")),n.push(parseInt(c.cookie("num")))):(e=c.cookie("sid").split(","),n=c.cookie("num").split(",")),c.each(e,function(i,t){var o,s;o=e[i],s=n[i],c.ajax({url:"http://localhost/Web-Shop/php/listdata.php",dataType:"json"}).done(function(i){c.each(i,function(i,t){if(o==t.sid){var e=(parseFloat(t.price)*parseFloat(s)).toFixed(2),n=c(".itemson .itemcar:hidden").clone(!0,!0);n.find(".t-goods").find("a").attr("href","Detail Pages.html?sid="+t.sid),n.find(".t-goods").find("a img").attr("src",t.url),n.find(".t-goods").find("a img").attr("sid",t.sid),n.find(".t-props p").html(t.title),n.find(".t-prices i").html(t.price),n.find(".t-quantity span").html(s),n.find(".t-sum i").html(e),n.css("display","flex"),c(".itemson").append(n),a()}})})})}function a(){var e=0,n=0;c(".itemson .goods-item:visible").each(function(i,t){c(t).find(".cart-checkbox input").prop("checked")&&(e+=parseInt(c(t).find(".t-quantity .num").html()),n+=parseFloat(c(t).find(".t-sum i").html()))}),c(".Total").find(".t-quantity i").html(e),c(".Total").find(".t-sum span").html(n.toFixed(2)),n=e=0}c(".allsel").on("change",function(){c(".goods-item:visible").find(":checkbox").prop("checked",c(this).prop("checked")),c(".allsel").prop("checked",c(this).prop("checked")),a()});var i=c(".goods-item:visible").find(":checkbox");c(".itemson").on("change",i,function(){c(".goods-item:visible").find(":checkbox").length===c(".goods-item:visible").find("input:checked").size()?c(".allsel").prop("checked",!0):c(".allsel").prop("checked",!1),a()}),c(".add").on("click",function(){var i=+c(this).parents(".itemcar").find(".num").html();i++,c(this).parents(".itemcar").find(".num").html(i);var t=(i*+c(this).parents(".itemcar").find(".t-prices i").html()).toFixed(2);c(this).parents(".itemcar").find(".price").html(t),a(),r(c(this))}),c(".reduce").on("click",function(){var i=+c(this).parents(".itemcar").find(".num").html();if(0<--i){c(this).parents(".itemcar").find(".num").html(i);var t=(i*+c(this).parents(".itemcar").find(".t-prices i").html()).toFixed(2);c(this).parents(".itemcar").find(".price").html(t)}a(),r(c(this))});var o=[],s=[];function d(){s=c.cookie("sid")&&c.cookie("num")?(o=c.cookie("sid").split(","),c.cookie("num").split(",")):(o=[],[])}function r(i){d();var t=i.parents(".goods-item").find("img").attr("sid");console.log(c.inArray(t,o)),s[c.inArray(t,o)]=i.parents(".goods-item").find(".t-quantity .num").html(),c.cookie("num",s,{expires:7})}function t(e,i){var n=-1;c.each(i,function(i,t){e==t&&(n=i)}),i.splice(n,1),s.splice(n,1),c.cookie("num",s,{expires:7}),c.cookie("sid",i,{expires:7})}c(".itemson ").on("click",".t-action a",function(){d(),c(this).parents(".goods-item").find(":checkbox").is(":checked")?window.confirm("你确定要删除这件商品吗?")&&(c(this).parents(".goods-item").remove(),t(c(this).parents(".goods-item").find("img").attr("sid"),o),a()):alert("请勾选后再操作")}),c(".Total  .t-goods a").on("click",function(){d();var e=!0;if(c(".itemson .goods-item:visible").each(function(i,t){c(t).find(".cart-checkbox input").prop("checked")&&(e=!1)}),e)return!1;window.confirm("你确定要删除选中的商品吗?")&&(c(".goods-item:visible").each(function(){c(this).find(":checkbox").is(":checked")&&(c(this).remove(),t(c(this).find("img").attr("sid"),o))}),a())})}(jQuery);